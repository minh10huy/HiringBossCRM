/*********************************************************************************
 * This file is part of KReporter. KReporter is an enhancement developed
 * by Christian Knoll. All rights are (c) 2012 by Christian Knoll
 *
 * This Version of the KReporter is licensed software and may only be used in
 * alignment with the License Agreement received with this Software.
 * This Software is copyrighted and may not be further distributed without
 * witten consent of Christian Knoll
 *
 * You can contact Christian Knoll at info@kreporter.org
 *
 ********************************************************************************/
function cV(){function cT(){return(((1+Math.random())*0x10000)|0).toString(16).substring(1);};return('k'+cT()+cT()+cT()+cT()+cT()+cT()+cT());};Ext.namespace('KINAMU.kreports');KINAMU.kreports.EditView=false;KINAMU.kreports.kreportsJsonStore=Ext.extend(Ext.data.JsonStore,{domElement:'',constructor:function(config){KINAMU.kreports.kreportsJsonStore.superclass.constructor.call(this,config);},loadData:function(o,append){KINAMU.kreports.kreportsJsonStore.superclass.loadData.call(this,o,append);},writeJson:function(){jArray=new Array();if(this.isFiltered()){for(i=0;i<this.snapshot.items.length;i++){jArray.push(Ext.util.JSON.encode(this.snapshot.items[i].data));}}else{for(i=0;i<this.data.items.length;i++){jArray.push(Ext.util.JSON.encode(this.data.items[i].data));}}document.getElementById(this.domElement).value='['+jArray.toString()+']';},loadDirect:function(){if(document.getElementById(this.domElement).value!='')this.loadData(Ext.util.JSON.decode(document.getElementById(this.domElement).value));},add:function(records){KINAMU.kreports.kreportsJsonStore.superclass.add.call(this,records);this.writeJson();},remove:function(record){KINAMU.kreports.kreportsJsonStore.superclass.remove.call(this,record);this.writeJson();},afterEdit:function(record){KINAMU.kreports.kreportsJsonStore.superclass.afterEdit.call(this,record);this.writeJson();},getMaxSequence:function(){var maxSequence=0;var i=0;while(i<this.getCount()){if(this.getAt(i).data.sequence>maxSequence)maxSequence=this.getAt(i).data.sequence;i++;}return parseInt(maxSequence,10);},getNextSequence:function(){cc=this.getMaxSequence()+1;if(cc<10)cc='0'+cc;return cc;}});var F=new Ext.data.JsonStore({fields:[{name:'lblid',type:'string'},{name:'value',type:'string'}]});if(document.getElementById('jsonlanguage').value!=''){var jsonLanguage;eval("jsonLanguage = "+document.getElementById('jsonlanguage').value);F.loadData(Ext.util.JSON.decode(document.getElementById('jsonlanguage').value));}var l=function(M){var recordNumber=F.find('lblid',M);if(recordNumber>=0){return F.getAt(recordNumber).data.value;}else{return M;}};Ext.namespace('KINAMU.kreports.mainEditToolbar');eW=false;if(document.getElementById('kreporteredition').value=='premium')eW=true;KINAMU.kreports.mainEditToolbar.username=new Ext.form.ComboBox({store:new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:'index.php?module=KReports&action=get_userids&to_pdf=true'}),reader:new Ext.data.JsonReader({root:'data',totalProperty:'count','fields':[{name:'value'},{name:'text'}]})}),displayField:'text',valueField:'value',forceSelection:true,typeAhead:false,loadingText:l('LBL_SEARCHING'),width:100,listWidth:200,pageSize:10,hideTrigger:false,triggerAction:'all',initializeFromForm:function(){this.setValue(document.getElementById('assigned_user_name').value);},listeners:{select:function(combo,record){document.getElementById('assigned_user_id').value=record.get('value');},beforerender:function(){this.initializeFromForm();}}});KINAMU.kreports.mainEditToolbar.teamname=new Ext.form.ComboBox({store:new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:'index.php?module=KReports&action=get_teamids&to_pdf=true'}),reader:new Ext.data.JsonReader({root:'data',totalProperty:'count','fields':[{name:'value'},{name:'text'}]})}),displayField:'text',valueField:'value',forceSelection:true,typeAhead:false,loadingText:l('LBL_SEARCHING'),width:100,listWidth:200,pageSize:10,hideTrigger:false,triggerAction:'all',initializeFromForm:function(){this.setValue(document.getElementById('team_name').value);},listeners:{select:function(combo,record){document.getElementById('team_id').value=record.get('value');},beforerender:function(){this.initializeFromForm();}}});KINAMU.kreports.mainEditToolbar.reportname=new Ext.form.TextField({width:130,listeners:{beforerender:function(){if(document.getElementById('name').value!='')this.setValue(document.getElementById('name').value);else this.setValue(l('LBL_DEFAULT_NAME'));},change:function(){document.getElementById('name').value=this.getValue();}}});KINAMU.kreports.mainEditToolbar.eH=new Ext.menu.CheckItem({text:l('LBL_AUTH_FULL'),group:'authCheck',id:'authcheck_full',checkHandler:function(thisElement){KINAMU.kreports.mainEditToolbar.setValues();}});KINAMU.kreports.mainEditToolbar.eD=new Ext.menu.CheckItem({text:l('LBL_AUTH_TOP'),group:'authCheck',id:'authcheck_top',checkHandler:function(thisElement){KINAMU.kreports.mainEditToolbar.setValues();}});KINAMU.kreports.mainEditToolbar.eS=new Ext.menu.CheckItem({text:l('LBL_AUTH_NONE'),group:'authCheck',id:'authcheck_none',checkHandler:function(thisElement){KINAMU.kreports.mainEditToolbar.setValues();}});KINAMU.kreports.mainEditToolbar.showDeleted=new Ext.menu.CheckItem({text:l('LBL_SHOW_DELETED'),id:'show_deleted',checkHandler:function(thisElement){KINAMU.kreports.mainEditToolbar.setValues();}});KINAMU.kreports.mainEditToolbar.testCheck=new Ext.menu.CheckItem({text:l('LBL_DYNOPTIONS_FOLDED'),id:'test_check',checkHandler:function(thisElement){KINAMU.kreports.mainEditToolbar.setValues();}});KINAMU.kreports.mainEditToolbar.dynamicOptionsFolded=new Ext.menu.CheckItem({text:l('LBL_DYNOPTIONS_FOLDED'),group:'dynOptions',id:'dynoptions_folded',checkHandler:function(thisElement){KINAMU.kreports.mainEditToolbar.setValues();}});KINAMU.kreports.mainEditToolbar.dynamicOptionsUnfolded=new Ext.menu.CheckItem({text:l('LBL_DYNOPTIONS_UNFOLDED'),group:'dynOptions',id:'dynoptions_unfolded',checkHandler:function(thisElement){KINAMU.kreports.mainEditToolbar.setValues();}});KINAMU.kreports.mainEditToolbar.resultsFolded=new Ext.menu.CheckItem({text:l('LBL_RESULTS_FOLDED'),group:'resultsFolded',id:'results_folded',checkHandler:function(thisElement){KINAMU.kreports.mainEditToolbar.setValues();}});KINAMU.kreports.mainEditToolbar.resultsUnfolded=new Ext.menu.CheckItem({text:l('LBL_RESULTS_UNFOLDED'),group:'resultsFolded',id:'results_unfolded',checkHandler:function(thisElement){KINAMU.kreports.mainEditToolbar.setValues();}});KINAMU.kreports.mainEditToolbar.showExport=new Ext.menu.CheckItem({text:l('LBL_SHOW_EXPORT'),id:'show_export',checkHandler:function(thisElement){KINAMU.kreports.mainEditToolbar.setValues();}});KINAMU.kreports.mainEditToolbar.showSnapshots=new Ext.menu.CheckItem({text:l('LBL_SHOW_SNAPSHOTS'),id:'show_snapshots',checkHandler:function(thisElement){KINAMU.kreports.mainEditToolbar.setValues();}});KINAMU.kreports.mainEditToolbar.showTools=new Ext.menu.CheckItem({text:l('LBL_SHOW_TOOLS'),id:'show_tools',checkHandler:function(thisElement){KINAMU.kreports.mainEditToolbar.setValues();}});KINAMU.kreports.mainEditToolbar.dynUpdateOnRequest=new Ext.menu.CheckItem({text:l('LBL_UPDATE_ON_REQUEST'),id:'update_on_request',checkHandler:function(thisElement){KINAMU.kreports.mainEditToolbar.setValues();}});KINAMU.kreports.mainEditToolbar.eL=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:'index.php?module=KReports&action=get_modules&to_pdf=true'}),reader:new Ext.data.JsonReader({'fields':[{name:'module'},{name:'description'}]}),listeners:{load:function(){prototypeRecord=new Ext.data.Record.create([{name:'module'},{name:'description'}]);newRecord=new prototypeRecord({module:'',description:'-'});this.insert(0,newRecord);}}});KINAMU.kreports.mainEditToolbar.eL.load();KINAMU.kreports.mainEditToolbar.eq=new Ext.form.ComboBox({store:KINAMU.kreports.mainEditToolbar.eL,valueField:'module',displayField:'description',typeAhead:true,mode:'local',triggerAction:'all',fieldLabel:'Module',editable:false,emptyText:l('LBL_SELECT_MODULE'),aR:true,width:135});KINAMU.kreports.mainEditToolbar.fg=new Ext.form.ComboBox({store:KINAMU.kreports.mainEditToolbar.eL,valueField:'module',displayField:'description',typeAhead:true,mode:'local',triggerAction:'all',fieldLabel:'Module',editable:false,emptyText:l('LBL_SELECT_MODULE'),aR:true,width:135});KINAMU.kreports.mainEditToolbar.ey=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:'index.php?module=KReports&action=get_tabs&to_pdf=true'}),reader:new Ext.data.JsonReader({'fields':[{name:'tab'},{name:'description'}]}),listeners:{load:function(){prototypeRecord=new Ext.data.Record.create([{name:'tab'},{name:'description'}]);newRecord=new prototypeRecord({tab:'',description:'-'});this.insert(0,newRecord);}}});KINAMU.kreports.mainEditToolbar.ey.load();KINAMU.kreports.mainEditToolbar.eV=new Ext.form.ComboBox({store:KINAMU.kreports.mainEditToolbar.ey,valueField:'tab',displayField:'description',typeAhead:true,mode:'local',triggerAction:'all',fieldLabel:'Tab',editable:false,emptyText:l('LBL_SELECT_TAB'),aR:true,width:135});KINAMU.kreports.mainEditToolbar.dT=new Ext.Window({title:l('LBL_PUBLISHPOPUP_TITLE'),layout:{type:'form',padding:10,align:'left'},width:400,autoHeight:true,closeAction:'hide',plain:true,items:[{xtype:'fieldset',title:l('LBL_PUBLISHPOPUP_DASHLET'),collapsible:false,autoHeight:true,defaults:{anchor:'-10'},defaultType:'textfield',items:[new Ext.form.Checkbox({id:'publishPopupDashletGridCheckBox',fieldLabel:l('LBL_PUBLISHPOPUP_GRID')}),new Ext.form.Checkbox({id:'publishPopupDashletChartCheckBox',fieldLabel:l('LBL_PUBLISHPOPUP_CHART')})]},{xtype:'fieldset',title:l('LBL_PUBLISHPOPUP_SUBPANEL'),collapsible:false,autoHeight:true,defaults:{anchor:'-10'},items:[KINAMU.kreports.mainEditToolbar.eq,KINAMU.kreports.mainEditToolbar.eV,new Ext.form.NumberField({id:'publishPopupSubpanelOrderField',fieldLabel:l('LBL_PUBLISHPOPUP_SUBPANELORDER')}),new Ext.form.Checkbox({id:'publishPopupSubpanelGridCheckBox',fieldLabel:l('LBL_PUBLISHPOPUP_GRID')}),new Ext.form.Checkbox({id:'publishPopupSubpanelChartCheckBox',fieldLabel:l('LBL_PUBLISHPOPUP_CHART')})]},{xtype:'fieldset',title:l('LBL_PUBLISHPOPUP_MENU'),collapsible:false,autoHeight:true,defaults:{anchor:'-10'},items:[KINAMU.kreports.mainEditToolbar.fg]}],buttons:[{text:l('LBL_PUBLISHPOPUP_CLOSE'),handler:function(){optionsObject=new Object();optionsObject.publishDashletGrid=Ext.getCmp('publishPopupDashletGridCheckBox').checked;optionsObject.publishDashletChart=Ext.getCmp('publishPopupDashletChartCheckBox').checked;optionsObject.publishSubpanelGrid=Ext.getCmp('publishPopupSubpanelGridCheckBox').checked;optionsObject.publishSubpanelChart=Ext.getCmp('publishPopupSubpanelChartCheckBox').checked;optionsObject.publishSubpanelOrder=Ext.getCmp('publishPopupSubpanelOrderField').getValue();optionsObject.publishSubpanelModule=KINAMU.kreports.mainEditToolbar.eq.getValue();optionsObject.publishSubpanelTab=KINAMU.kreports.mainEditToolbar.eV.getValue();optionsObject.publishMenuModule=KINAMU.kreports.mainEditToolbar.fg.getValue();document.getElementById('publishoptions').value=Ext.util.JSON.encode(optionsObject);KINAMU.kreports.mainEditToolbar.dT.hide();}}],listeners:{show:function(){fm=document.getElementById('publishoptions').value;if(fm!=''){fd=Ext.util.JSON.decode(fm);Ext.getCmp('publishPopupDashletGridCheckBox').setValue(fd.publishDashletGrid);Ext.getCmp('publishPopupDashletChartCheckBox').setValue(fd.publishDashletChart);Ext.getCmp('publishPopupSubpanelGridCheckBox').setValue(fd.publishSubpanelGrid);Ext.getCmp('publishPopupSubpanelChartCheckBox').setValue(fd.publishSubpanelChart);Ext.getCmp('publishPopupSubpanelOrderField').setValue(fd.publishSubpanelOrder);KINAMU.kreports.mainEditToolbar.eq.setValue(fd.publishSubpanelModule);KINAMU.kreports.mainEditToolbar.eV.setValue(fd.publishSubpanelTab);KINAMU.kreports.mainEditToolbar.fg.setValue(fd.publishMenuModule);}}}});KINAMU.kreports.mainEditToolbar.reportOptions=new Ext.menu.Menu({style:{overflow:'visible'},items:[{text:l('LBL_AUTH_CHECK'),icon:'modules/KReports/images/listlimit.png',menu:{items:[KINAMU.kreports.mainEditToolbar.eH,KINAMU.kreports.mainEditToolbar.eD,KINAMU.kreports.mainEditToolbar.eS,'-',KINAMU.kreports.mainEditToolbar.showDeleted]}},{text:l('LBL_FOLDED_PANELS'),icon:'modules/KReports/images/listlimit.png',menu:{items:[KINAMU.kreports.mainEditToolbar.dynamicOptionsFolded,KINAMU.kreports.mainEditToolbar.dynamicOptionsUnfolded,'-',KINAMU.kreports.mainEditToolbar.resultsFolded,KINAMU.kreports.mainEditToolbar.resultsUnfolded]}},{text:l('LBL_DATA_UPDATE'),icon:'modules/KReports/images/listlimit.png',menu:{items:[KINAMU.kreports.mainEditToolbar.dynUpdateOnRequest]}},{text:l('LBL_OPTIONS_MENUITEMS'),icon:'modules/KReports/images/listlimit.png',menu:{items:[KINAMU.kreports.mainEditToolbar.showExport,KINAMU.kreports.mainEditToolbar.showSnapshots,KINAMU.kreports.mainEditToolbar.showTools]}},{text:l('LBL_PUBLISH_OPTION'),icon:'modules/KReports/images/publish.png',handler:function(){KINAMU.kreports.mainEditToolbar.dT.show();},disabled: !eW}]});if(l('report_status_options')!=''){eval('KINAMU.kreports.mainEditToolbar.statusComboOptions = '+Ext.util.Format.htmlDecode(l('report_status_options')));}else KINAMU.kreports.mainEditToolbar.statusComboOptions=[];KINAMU.kreports.mainEditToolbar.statusCombo=new Ext.form.ComboBox({typeAhead:true,triggerAction:'all',lazyRender:true,mode:'local',store:new Ext.data.ArrayStore({fields:['key','displayText'],data:KINAMU.kreports.mainEditToolbar.statusComboOptions}),valueField:'key',displayField:'displayText',listeners:{beforerender:function(){if(document.getElementById('report_status').value!='')this.setValue(document.getElementById('report_status').value);},change:function(){document.getElementById('report_status').value=this.getValue();}}});KINAMU.kreports.mainEditToolbar.getValues=function(){optionsObject=Ext.util.JSON.decode(document.getElementById('reportoptions').value);switch(optionsObject.authCheck){case 'none':if(!KINAMU.kreports.mainEditToolbar.eS.checked)KINAMU.kreports.mainEditToolbar.eS.setChecked(true,true);break;case 'top':if(!KINAMU.kreports.mainEditToolbar.eD.checked)KINAMU.kreports.mainEditToolbar.eD.setChecked(true,true);break;default:if(!KINAMU.kreports.mainEditToolbar.eH.checked)KINAMU.kreports.mainEditToolbar.eH.setChecked(true,true);break;}if(optionsObject.showDeleted!=undefined&&optionsObject.showDeleted==true)KINAMU.kreports.mainEditToolbar.showDeleted.setChecked(true,true);else KINAMU.kreports.mainEditToolbar.showDeleted.setChecked(false,true);if(optionsObject.optionsFolded==undefined||optionsObject.optionsFolded==false)KINAMU.kreports.mainEditToolbar.dynamicOptionsUnfolded.setChecked(true,true);else KINAMU.kreports.mainEditToolbar.dynamicOptionsFolded.setChecked(true,true);if(optionsObject.resultsFolded)KINAMU.kreports.mainEditToolbar.resultsFolded.setChecked(true,true);else KINAMU.kreports.mainEditToolbar.resultsUnfolded.setChecked(true,true);if(optionsObject.showExport==undefined||optionsObject.showExport==false)KINAMU.kreports.mainEditToolbar.showExport.setChecked(false,true);else KINAMU.kreports.mainEditToolbar.showExport.setChecked(true,true);if(optionsObject.showSnapshots==undefined||optionsObject.showSnapshots==false)KINAMU.kreports.mainEditToolbar.showSnapshots.setChecked(false,true);else KINAMU.kreports.mainEditToolbar.showSnapshots.setChecked(true,true);if(optionsObject.showTools==undefined||optionsObject.showTools==false)KINAMU.kreports.mainEditToolbar.showTools.setChecked(false,true);else KINAMU.kreports.mainEditToolbar.showTools.setChecked(true,true);if(optionsObject.updateOnRequest==undefined||optionsObject.updateOnRequest==false)KINAMU.kreports.mainEditToolbar.dynUpdateOnRequest.setChecked(false,true);else KINAMU.kreports.mainEditToolbar.dynUpdateOnRequest.setChecked(true,true);};KINAMU.kreports.mainEditToolbar.setValues=function(){optionsArray=new Object();if(KINAMU.kreports.mainEditToolbar.resultsUnfolded.checked==true)optionsArray.resultsFolded=false;if(KINAMU.kreports.mainEditToolbar.resultsFolded.checked==true)optionsArray.resultsFolded=true;if(KINAMU.kreports.mainEditToolbar.dynamicOptionsUnfolded.checked==true)optionsArray.optionsFolded=false;if(KINAMU.kreports.mainEditToolbar.dynamicOptionsFolded.checked==true)optionsArray.optionsFolded=true;if(KINAMU.kreports.mainEditToolbar.eH.checked==true)optionsArray.authCheck='full';if(KINAMU.kreports.mainEditToolbar.eD.checked==true)optionsArray.authCheck='top';if(KINAMU.kreports.mainEditToolbar.eS.checked==true)optionsArray.authCheck='none';if(KINAMU.kreports.mainEditToolbar.showDeleted.checked)optionsArray.showDeleted=true;else optionsArray.showDeleted=false;if(KINAMU.kreports.mainEditToolbar.showExport.checked)optionsArray.showExport=true;else optionsArray.showExport=false;if(KINAMU.kreports.mainEditToolbar.showSnapshots.checked)optionsArray.showSnapshots=true;else optionsArray.showSnapshots=false;if(KINAMU.kreports.mainEditToolbar.showTools.checked)optionsArray.showTools=true;else optionsArray.showTools=false;if(KINAMU.kreports.mainEditToolbar.dynUpdateOnRequest.checked)optionsArray.updateOnRequest=true;else optionsArray.updateOnRequest=false;document.getElementById('reportoptions').value=Ext.util.JSON.encode(optionsArray);};KINAMU.kreports.mainEditToolbar.reportOptions.on('show',function(){KINAMU.kreports.mainEditToolbar.getValues();});KINAMU.kreports.mainEditToolbar.Toolbar=new Ext.Toolbar({renderTo:'toolbarArea',items:[{text:l('LBL_SAVE_BUTTON_LABEL'),icon:'modules/KReports/images/save.png',handler:function(){var form=document.getElementById('EditView');form.action.value='Save';form.submit();},disabled:false},{text:l('LBL_CANCEL_BUTTON_LABEL'),icon:'modules/KReports/images/cancel.png',handler:function(){var form=document.getElementById('EditView');if(form.record.value=='')form.action.value='index';else form.action.value='DetailView';form.module.value='KReports';form.submit();},disabled:false},'-',{xtype:'tbtext',text:l('LBL_REPORT_NAME_LABEL')},KINAMU.kreports.mainEditToolbar.reportname,{icon:'modules/KReports/images/longtext.png',handler:function(){KINAMU.kreports.mainEditToolbar.descriptionTextArea=new Ext.form.HtmlEditor({});KINAMU.kreports.mainEditToolbar.descriptionPopupwin=new Ext.Window({layout:'fit',width:600,height:400,closeAction:'close',plain:true,title:'Description',items:KINAMU.kreports.mainEditToolbar.descriptionTextArea,listeners:{beforeclose:function(){document.getElementById('description').value=KINAMU.kreports.mainEditToolbar.descriptionTextArea.getValue();}}});KINAMU.kreports.mainEditToolbar.descriptionTextArea.setValue(document.getElementById('description').value);KINAMU.kreports.mainEditToolbar.descriptionPopupwin.show();},disabled:false},'-',KINAMU.kreports.mainEditToolbar.statusCombo,'-',{xtype:'tbtext',text:l('LBL_ASSIGNED_USER_LABEL')},' ',KINAMU.kreports.mainEditToolbar.username,' ',{xtype:'tbtext',text:l('LBL_ASSIGNED_TEAM_LABEL')},' ',KINAMU.kreports.mainEditToolbar.teamname,'-',{text:l('LBL_REPORT_OPTIONS'),icon:'modules/KReports/images/tools.png',menu:KINAMU.kreports.mainEditToolbar.reportOptions},'->',{xtype:'tbtext',text:'K Reporter v2.7.7',style:{fontWeight:'bold',fontStyle:'italic'}}]});var m=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:'index.php?module=KReports&action=get_enum&to_pdf=true'}),reader:new Ext.data.JsonReader({'fields':[{name:'value'},{name:'text'}]})});var aS=new Ext.form.ComboBox({typeAhead:true,triggerAction:'all',lazyRender:true,mode:'local',store:m,displayField:'text'});var as=[['ignore',0],['equals',1],['soundslike',1],['notequal',1],['greater',1],['greaterequal',1],['less',1],['lessequal',1],['starts',1],['notstarts',1],['contains',1],['notcontains',1],['between',2],['isempty',0],['isemptyornull',0],['isnull',0],['isnotempty',0]];var whereOperatorsId=[['equals',1],['autocomplete',1],['isempty',0],['isemptyornull',0],['isnull',0],['isnotempty',0]];var ay=[['ignore',0],['equals',1],['notequal',1],['greater',1],['greaterequal',1],['less',1],['lessequal',1],['between',2],['isempty',0],['isemptyornull',0],['isnull',0],['isnotempty',0]];var aA=[['ignore',0],['equals',1],['notequal',1],['oneof',1],['oneofnot',1],['oneofnotornull',1],['starts',1],['notstarts',1],['contains',1],['notcontains',1],['isempty',0],['isemptyornull',0],['isnull',0],['isnotempty',0]];var aB=[['ignore',0],['equals',1],['notequal',1],['before',1],['after',1],['between',2],['today',0],['past',0],['future',0],['thismonth',0],['notthismonth',0],['thisweek',0],['next3month',0],['lastmonth',0],['last3month',0],['lastndays',1],['lastnfdays',1],['lastnddays',1],['lastnweeks',1],['notlastnweeks',1],['lastnfweeks',1],['nextndays',1],['nextnddays',1],['betwndays',2],['betwnddays',2],['nextnweeks',1],['notnextnweeks',1],['thisyear',0],['lastyear',0],['tyytd',0],['lyytd',0],['isempty',0],['isemptyornull',0],['isnull',0],['isnotempty',0]];var aG=[['ignore',0],['equals',1],['notequal',1],['isemptyornull',0],['isnull',0]];var whereOperatorsFields=[{name:'operator'},{name:'values',type:'float'},{name:'display'}];var af=new Ext.data.ArrayStore({fields:whereOperatorsFields,loadArray:function(data){this.loadData(data);if(KINAMU.kreports.EditView&&document.getElementById('publishoptions').value!=''){fd=Ext.util.JSON.decode(document.getElementById('publishoptions').value);if(fd.publishSubpanelModule!=''){addPrototypeRecord=Ext.data.Record.create(whereOperatorsFields);this.add(new addPrototypeRecord({operator:'parent_assign',values:1}));}}if(KINAMU.kreports.EditView){addPrototypeRecord=Ext.data.Record.create(whereOperatorsFields);this.add(new addPrototypeRecord({operator:'function',values:1}));}if(KINAMU.kreports.EditView){addPrototypeRecord=Ext.data.Record.create(whereOperatorsFields);this.add(new addPrototypeRecord({operator:'reference',values:1}));}var V=function(record){record.set('display',l('LBL_OP_'+record.data.operator.toUpperCase()));};this.each(V);}});var av=function(ap){af.removeAll();switch(ap){case 'date':case 'datetime':case 'datetimecombo':af.loadArray(aB);break;case 'id':af.loadArray(whereOperatorsId);break;case 'relate':case 'varchar':case 'char':case 'text':case 'name':af.loadArray(as);break;case 'int':case 'double':case 'float':case 'currency':af.loadArray(ay);break;case 'bool':af.loadArray(aG);break;case 'enum':case 'multienum':case 'radioenum':case 'parent_type':case 'user_name':case 'assigned_user_name':case 'team_name':af.loadArray(aA);break;}};var aE=function(aQ,ap){av(ap);var aw=af.find('operator',aQ);if(aw>=0){return af.getAt(aw).data.values;}else{return 0;}};whereFieldGridParentFieldsStore=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:'index.php?module=KReports&action=get_modulefields&to_pdf=true'}),reader:new Ext.data.JsonReader({'fields':[{name:'field'},{name:'description'}]})});whereFieldGridFunctionsStore=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:'index.php?module=KReports&action=get_wherefunctions&to_pdf=true'}),reader:new Ext.data.JsonReader({'fields':[{name:'field'},{name:'description'}]})});whereFieldGridAutocompleteStore=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:'index.php?module=KReports&action=get_autocompletevalues&to_pdf=true'}),reader:new Ext.data.JsonReader({'fields':[{name:'itemid'},{name:'itemtext'}]})});var B;var J;var R;var currentEditedColumn;var whereGridLastClickXY=new Object();var aF=function(e,ag,ah){if(ag.getColumnId(e.column)=='onoffswitch'){if(e.record.data.usereditable=='yo1'||e.record.data.usereditable=='yo2'){ah.getColumnModel().setEditor(e.column,new Ext.form.ComboBox({typeAhead:true,triggerAction:'all',lazyRender:true,mode:'local',store:new Ext.data.ArrayStore({id:0,fields:['value','text'],data:[['yo1',l('LBL_ONOFF_YO1')],['yo2',l('LBL_ONOFF_YO2')]]}),displayField:'text',valueField:'value'}));}else ah.getColumnModel().setEditor(null);}if(ag.getColumnId(e.column)=='value'||ag.getColumnId(e.column)=='valueto'){var ax=aE(e.record.data.operator,e.record.data.type);if(!KINAMU.kreports.EditView){if(e.record.data.usereditable=='yo1'||e.record.data.usereditable=='yo2')ax=0;}if(ax===0||(ag.getColumnId(e.column)=='valueto'&&ax!=2)){ah.getColumnModel().setEditor(null);}else{switch(e.record.data.operator){case 'autocomplete':whereFieldGridAutocompleteStore.setBaseParam('path',e.record.data.path);fv=new Ext.form.ComboBox({store:whereFieldGridAutocompleteStore,valueField:'itemid',displayField:'itemtext',typeAhead:true,mode:'remote',triggerAction:'all',forceSelection:true,aR:true,listWidth:200});ah.getColumnModel().setEditor(e.column,fv);break;case 'parent_assign':whereFieldGridParentFieldsStore.removeAll();whereFieldGridParentFieldsStore.setBaseParam('inputmodule',Ext.util.JSON.decode(document.getElementById('publishoptions').value).publishSubpanelModule);whereFieldGridParentFieldsStore.load();eB=new Ext.form.ComboBox({store:whereFieldGridParentFieldsStore,valueField:'field',displayField:'description',typeAhead:true,mode:'local',triggerAction:'all',editable:false,aR:true,listWidth:200});ah.getColumnModel().setEditor(e.column,eB);break;case 'function':whereFieldGridFunctionsStore.removeAll();whereFieldGridFunctionsStore.load();fj=new Ext.form.ComboBox({store:whereFieldGridFunctionsStore,valueField:'field',displayField:'description',typeAhead:true,mode:'local',triggerAction:'all',editable:false,aR:true,listWidth:200});ah.getColumnModel().setEditor(e.column,fj);break;case 'reference':ah.getColumnModel().setEditor(e.column,new Ext.form.TextField());break;default:switch(e.record.data.type){case 'datetimecombo':case 'datetime':switch(e.record.data.operator){case 'lastndays':case 'lastnfdays':case 'lastnweeks':case 'notlastnweeks':case 'lastnfweeks':case 'nextndays':case 'nextnweeks':case 'notnextnweeks':case 'betwndays':ah.getColumnModel().setEditor(e.column,new Ext.form.NumberField());break;default:if(KINAMU.kreports.EditView&&(e.record.data.operator=='lastnddays'||e.record.data.operator=='nextnddays'||e.record.data.operator=='betwnddays'))ah.getColumnModel().setEditor(e.column,new Ext.form.NumberField());else{ah.getColumnModel().setEditor(e.column,new Ext.form.NumberField({}));B=e;J=ah;R=ag;currentEditedColum=ag.getColumnId(e.column);if(e.record.get(currentEditedColum)!=''){var dateArray=e.record.get(currentEditedColum).split(' ');var timeArray=dateArray[1].split(':');}else{var dateArray=['','00:00:00'];var timeArray=dateArray[1].split(':');}var thisDateField=new Ext.form.DateField({fieldLabel:l('LBL_DATETIMEPICKER_DATE'),width:130,value:dateArray[0],format:cal_date_format.replace(/%/g,'')});var thisHourField=new Ext.form.NumberField({name:'hours',xtype:'numberfield',value:timeArray[0],minValue:0,maxValue:23,allowNegative:false,listeners:{'invalid':function(){if(this.getValue()>23)this.setValue(23);if(this.getValue()<0)this.setValue(0);}},width:40});var thisMinuteField=new Ext.form.NumberField({name:'minutes',xtype:'numberfield',value:timeArray[1],minValue:0,maxValue:59,setValue:function(v){v=this.fixPrecision(v);v=Ext.isNumber(v)?v:parseFloat(String(v).replace(this.decimalSeparator,"."));v=isNaN(v)?'':String(v).replace(".",this.decimalSeparator);if(v<10)v='0'+v;return Ext.form.NumberField.superclass.setValue.call(this,v);},allowNegative:false,getTimeValue:function(){if(this.getValue()>10)return this.getValue();else return '0'+this.getValue()},listeners:{'invalid':function(){if(this.getValue()>59)this.setValue(59);if(this.getValue()<0)this.setValue(0);}},width:40});var thisSecondField=new Ext.form.NumberField({name:'seconds',xtype:'numberfield',value:timeArray[2],minValue:0,maxValue:59,allowNegative:false,setValue:function(v){v=this.fixPrecision(v);v=Ext.isNumber(v)?v:parseFloat(String(v).replace(this.decimalSeparator,"."));v=isNaN(v)?'':String(v).replace(".",this.decimalSeparator);if(v<10)v='0'+v;return Ext.form.NumberField.superclass.setValue.call(this,v);},getTimeValue:function(){if(this.getValue()>10)return this.getValue();else return '0'+this.getValue()},listeners:{'invalid':function(){if(this.getValue()>59)this.setValue(59);if(this.getValue()<0)this.setValue(0);}},width:40});var win=new Ext.Window({title:l('LBL_DATETIMEPICKER_POPUP_TITLE'),layout:'form',drggable:true,x:whereGridLastClickXY[0],y:whereGridLastClickXY[1],labelWidth:50,width:250,closeAction:'hide',draggable:true,modal:true,items:[thisDateField,{xtype:'compositefield',fieldLabel:'Time',combineErrors:false,items:[thisHourField,{xtype:'displayfield',width:3,value:':'},thisMinuteField,{xtype:'displayfield',width:3,value:':'},thisSecondField]}],buttons:[{text:l('LBL_DATETIMEPICKER_CANCEL_BUTTON'),handler:function(){win.close();}},{text:l('LBL_DATETIMEPICKER_CLOSE_BUTTON'),handler:function(){B.record.set(currentEditedColum,thisDateField.getValue().format(cal_date_format.replace(/%/g,'')+' '+thisHourField.getValue()+':'+thisMinuteField.getTimeValue()+':'+thisSecondField.getTimeValue()));B.record.set(currentEditedColum+'key',thisDateField.getValue().format('Y-m-d'+' '+thisHourField.getValue()+':'+thisMinuteField.getTimeValue()+':'+thisSecondField.getTimeValue()));J.fireEvent('afteredit',B);win.close();}}]});win.show(this);}break;}break;case 'date':switch(e.record.data.operator){case 'lastndays':case 'lastnfdays':case 'lastnweeks':case 'notlastnweeks':case 'lastnfweeks':case 'nextndays':case 'nextnweeks':case 'notnextnweeks':case 'betwndays':ah.getColumnModel().setEditor(e.column,new Ext.form.NumberField());break;case 'lastnddays':case 'nextnddays':case 'betwnddays':if(KINAMU.kreports.EditView)ah.getColumnModel().setEditor(e.column,new Ext.form.NumberField());else ah.getColumnModel().setEditor(e.column,new Ext.form.DateField({editable:false,value:e.value,format:cal_date_format.replace(/%/g,'')}));break;default:ah.getColumnModel().setEditor(e.column,new Ext.form.DateField({editable:false,format:cal_date_format.replace(/%/g,'')}));break;}break;case 'user_name':case 'assigned_user_name':case 'enum':case 'parent_type':case 'radioenum':case 'multienum':if(e.record.data.operator=='starts'||e.record.data.operator=='notstarts'||e.record.data.operator=='contains'||e.record.data.operator=='notcontains'){ah.getColumnModel().setEditor(e.column,new Ext.form.TextField());}else{m.removeAll();m.setBaseParam('path',e.record.data.path);m.load();switch(e.record.data.operator){case('oneof'):case('oneofnot'):case('oneofnotornull'):var msGridView=new Ext.grid.GridView({listeners:{'refresh':function(){var I=B.record.data.valuekey.split(',');for(var i=0;i<I.length;i++){var G=m.find('value',I[i]);if(G!= -1){at.getSelectionModel().selectRow(G,true);}}}}});var at=new Ext.grid.GridPanel({store:m,columns:[{id:'text',header:l('LBL_MULTISELECT_VALUE_HEADER'),hidden:true},{id:'value',header:l('LBL_MULTISELECT_TEXT_HEADER')}],view:msGridView,stripeRows:true,autoExpandColumn:'value',height:350,width:600});B=e;J=ah;R=ag;var win=new Ext.Window({title:l('LBL_MUTLISELECT_POPUP_TITLE'),layout:'fit',width:500,height:300,closeAction:'hide',draggable:true,modal:true,items:at,buttons:[{text:l('LBL_MUTLISELECT_CANCEL_BUTTON'),handler:function(){win.close();}},{text:l('LBL_MUTLISELECT_CLOSE_BUTTON'),handler:function(){var aa=at.getSelectionModel();var selectedRows=aa.getSelections();var newValue='';var an='';for(var i=0,O=selectedRows.length;i<O;i++){if(newValue!=''){newValue+=', ';}newValue+=selectedRows[i].data.text;if(an!=''){an+=',';}an+=selectedRows[i].data.value;}B.record.set('value',newValue);B.record.set('valuekey',an);J.fireEvent('afteredit',B);win.close();}}]});win.show(this);break;default:ah.getColumnModel().setEditor(e.column,new Ext.form.ComboBox({typeAhead:true,triggerAction:'all',lazyRender:true,mode:'local',store:m,displayField:'text',valueField:'value'}));break;}}break;case 'bool':ah.getColumnModel().setEditor(e.column,new Ext.form.ComboBox({typeAhead:true,triggerAction:'all',lazyRender:true,mode:'local',store:new Ext.data.ArrayStore({id:0,fields:['value','text'],data:[['1',l('LBL_BOOL_1')],['0',l('LBL_BOOL_0')]]}),displayField:'text',valueField:'value'}));break;default:ah.getColumnModel().setEditor(e.column,new Ext.form.TextField());break;}break;}}}if(ag.getColumnId(e.column)=='operator'){if(e.record.data.usereditable=='yes'||KINAMU.kreports.EditView){av(e.record.data.type);ah.getColumnModel().setEditor(e.column,new Ext.form.ComboBox({typeAhead:true,triggerAction:'all',lazyRender:true,mode:'local',editable:false,store:af,displayField:'display',valueField:'operator'}));}else ah.getColumnModel().setEditor(null);}};var aI=function(e,ag){if(ag.getColumnId(e.column)=='value'||ag.getColumnId(e.column)=='valueto'){switch(e.record.data.operator){case 'autocomplete':e.record.set(ag.getColumnId(e.column)+'key',e.value);e.record.set(ag.getColumnId(e.column),whereFieldGridAutocompleteStore.getAt(whereFieldGridAutocompleteStore.find('itemid',e.value)).data.itemtext);break;case 'parent_assign':e.record.set(ag.getColumnId(e.column)+'key',e.value);e.record.set(ag.getColumnId(e.column),whereFieldGridParentFieldsStore.getAt(whereFieldGridParentFieldsStore.find('field',e.value)).data.description);break;case 'function':e.record.set(ag.getColumnId(e.column)+'key',e.value);e.record.set(ag.getColumnId(e.column),whereFieldGridFunctionsStore.getAt(whereFieldGridFunctionsStore.find('field',e.value)).data.description);break;default:switch(e.record.data.type){case 'datetime':case 'datetimecombo':break;case 'date':switch(e.record.data.operator){case 'lastndays':case 'lastnfdays':case 'lastnweeks':case 'notlastnweeks':case 'lastnfweeks':case 'nextndays':case 'nextnweeks':case 'notnextnweeks':case 'betwndays':break;case 'lastnddays':case 'nextnddays':case 'betwnddays':if(!KINAMU.kreports.EditView){e.record.set(ag.getColumnId(e.column)+'key',e.value.format('Y-m-d'));e.record.set(ag.getColumnId(e.column),e.value.format(cal_date_format.replace(/%/g,'')));}break;default:e.record.set(ag.getColumnId(e.column)+'key',e.value.format('Y-m-d'));e.record.set(ag.getColumnId(e.column),e.value.format(cal_date_format.replace(/%/g,'')));break;}break;case 'user_name':case 'assigned_user_name':case 'enum':case 'radioenum':case 'parent_type':case 'multienum':switch(e.record.data.operator){case('oneof'):break;case('starts'):case('notstarts'):case('contains'):case('notcontains'):break;default:e.record.set(ag.getColumnId(e.column)+'key',e.value);e.record.set(ag.getColumnId(e.column),m.getAt(m.find('value',e.value)).data.text);break;}break;case 'bool':e.record.set(ag.getColumnId(e.column)+'key',e.value);e.record.set(ag.getColumnId(e.column),l('LBL_BOOL_'+e.value));break;default:break;}break;}}if(ag.getColumnId(e.column)=='operator'){e.record.set('value','');e.record.set('valueto','');e.record.set('valuekey','');e.record.set('valuetokey','');}};function cf(){if(!ef.collapsed){return 'root';}else{return KINAMU.kreports.dI.cI(null);}};var bJ=[{name:'unionid',mapping:'unionid'},{name:'id',mapping:'id'},{name:'group',mapping:'group'},{name:'type',mapping:'type'},{name:'parent',mapping:'parent'},{name:'notexists',mapping:'notexists'}];var ad=new KINAMU.kreports.kreportsJsonStore({fields:bJ,domElement:'wheregroups',idProperty:'id'});var aY=new Ext.tree.TreeNode({text:"root",selected:true,leaf:false,draggable:false,id:"root"});var currentNode=aY;var cj=function(){aY.removeAll();bM(aY,'root');bK(aY);};var bM=function(bY,nodeid){ad.filter('unionid',cf());if(nodeid!='root'){bP=ad.getAt(ad.find('id',nodeid));var aZ=bY.appendChild(new Ext.tree.TreeNode({text:bP.data.group,id:bP.data.id,selected:true,draggable:false}));}else{by=ad.find('id','root');if(by== -1){bR(aY);}var aZ=aY;}ad.filter([{property:'parent',value:nodeid},{property:'unionid',value:cf()}]);var addChild=function(record){bM(aZ,record.id);};ad.each(addChild);ad.clearFilter();};var bR=function(aZ){var bQ=Ext.data.Record.create(bJ);if(aZ.id!='root'){var bF=new bQ({unionid:cf(),id:aZ.id,group:aZ.text,parent:aZ.parentNode.id,type:'AND'});bF.id=aZ.id;}else{var bF=new bQ({unionid:cf(),id:aZ.id,group:aZ.text,parent:'-',type:'AND'});}ad.add(bF);};var cD=function(id,ap){ad.filter('unionid',cf());var aX=ad.find('id',id);if(aX!= -1){var ba=ad.getAt(aX);ba.set('type',ap);}ad.clearFilter(true);};var cz=function(id,cb){var aX=ad.find('id',id);if(aX!= -1){var ba=ad.getAt(aX);if(cb){ba.set('notexists','1');}else{ba.set('notexists','');}}};var cC=function(id,bZ){var aX=ad.find('id',id);if(aX!= -1){var ba=ad.getAt(aX);ba.set('group',bZ);}};var cB=new Ext.Button({text:l('LBL_ADD_BUTTON_LABEL'),icon:'modules/KReports/images/link_add.png',handler:function(){Ext.Msg.prompt(l('LBL_ADD_GROUP_NAME'),l('LBL_CHANGE_GROUP_NAME_PROMPT'),function(f,text){if(f=='ok'){var bX=currentNode.appendChild(new Ext.tree.TreeNode({id:cV(),text:text,selected:true,draggable:false}));bR(bX);bA.disable();}});}});var bA=new Ext.Button({text:l('LBL_DELETE_BUTTON_LABEL'),icon:'modules/KReports/images/link_delete.png',handler:function(){var aX=ad.find('id',currentNode.id);if(aX!= -1){var ba=ad.getAt(aX);ad.remove(ba);}currentNode.remove();},disabled:true});var bw=new Ext.Button({text:l('LBL_EDIT_BUTTON_LABEL'),icon:'modules/KReports/images/link_edit.png',handler:function(){Ext.Msg.prompt(l('LBL_CHANGE_GROUP_NAME'),l('LBL_CHANGE_GROUP_NAME_PROMPT'),function(f,text){if(f=='ok'){cC(currentNode.id,text);currentNode.setText(text);}});},disabled:true});var bs=new Ext.form.ComboBox({store:['AND','OR'],name:'group Clause',typeAhead:true,editable:false,mode:'local',triggerAction:'all',emptyText:'Select a type.',aR:true,value:'AND',width:50});bs.on('select',function(){cD(currentNode.id,bs.value);});var cA=new Ext.form.Label({text:l('LBL_SELECTION_CLAUSE')});var bt=new Ext.form.Checkbox({boxLabel:'where Exists',name:'where Exists Checkbox'});bt.on('check',function(){cz(currentNode.id,bt.checked);});var bK=function(n){ai.clearFilter(true);ad.filter('unionid',cf());if(n.parentNode!=null){if(n.hasChildNodes()||ai.find('groupid',n.id)!= -1){bA.disable();}else{bA.enable();}bw.enable();currentNode=n;}else{bA.disable();bw.disable();currentNode=n;}var aX=ad.find('id',currentNode.id);if(aX!= -1){var ba=ad.getAt(aX);bs.setValue(ba.data.type);if(ba.data.notexists=='1'){bt.setValue(true);}else{bt.setValue(false);}}ai.filter([{property:'groupid',value:currentNode.id},{property:'unionid',value:cf()}])};var bb=new Ext.tree.TreePanel({id:'wheretreepanel',split:true,flex:50,width:250,minSize:100,autoScroll:true,rootVisible:true,lines:false,singleExpand:true,useArrows:true,enableDragDrop:false,root:aY,listeners:{click:bK},tbar:new Ext.Toolbar({items:[cB,bA,bw,{xtype:'tbseparator'},cA,{xtype:'tbspacer',width:10},bs]})});var cn=function(n){n.destroy();};var bW=function(){bb.root.eachChild(cn);};KINAMU.kreports.aO=[{name:'unionid',mapping:'unionid'},{name:'sequence',mapping:'sequence'},{name:'fieldid',mapping:'fieldid'},{name:'name',mapping:'name'},{name:'groupid',mapping:'groupid'},{name:'path',mapping:'path'},{name:'displaypath',mapping:'displaypath'},{name:'referencefieldid',mapping:'referencefieldid'},{name:'operator',mapping:'operator'},{name:'type',mapping:'type'},{name:'value',mapping:'value'},{name:'valuekey',mapping:'valuekey'},{name:'valueto',mapping:'valueto'},{name:'valuetokey',mapping:'valuetokey'},{name:'jointype',mapping:'jointype'},{name:'context',mapping:'context'},{name:'reference',mapping:'reference'},{name:'include',mapping:'include'},{name:'usereditable',mapping:'usereditable'},{name:'dashleteditable',mapping:'dashleteditable'},{name:'exportpdf',mapping:'exportpdf'}];var ai=new KINAMU.kreports.kreportsJsonStore({fields:KINAMU.kreports.aO,domElement:'whereconditions',paramsAsHash:true});var ag=new Ext.grid.ColumnModel([{header:l('LBL_FIELDNAME'),readOnly:true,dataIndex:'displaypath',width:150,sortable:true,hidden:false},{id:'sequence',header:l('LBL_SEQUENCE'),dataIndex:'sequence',sortable:true,editor:new Ext.form.TextField(),width:30},{id:'exportpdf',header:l('LBL_EXPORTPDF'),dataIndex:'exportpdf',sortable:true,renderer:function(value,metaData,record,rowIndex,colIndex,store){if(value!='')return l('LBL_UEOPTION_'+value.toUpperCase());else return value;},editor:new Ext.form.ComboBox({typeAhead:true,triggerAction:'all',lazyRender:true,mode:'local',store:new Ext.data.ArrayStore({id:0,fields:['value','text'],data:[['no',l('LBL_UEOPTION_NO')],['yes',l('LBL_UEOPTION_YES')]]}),displayField:'text',valueField:'value'}),width:60},{id:'name',header:l('LBL_NAME'),dataIndex:'name',sortable:true,editor:new Ext.form.TextField(),width:150},{id:'type',header:l('LBL_TYPE'),dataIndex:'type',sortable:false,hidden:true,width:50},{id:'operator',header:l('LBL_OPERATOR'),readOnly:true,dataIndex:'operator',width:80,sortable:true,hidden:false,renderer:function(value,metaData,record,rowIndex,colIndex,store){return l('LBL_OP_'+value.toUpperCase());},editor:new Ext.form.TextField()},{id:'value',header:l('LBL_VALUE_FROM'),dataIndex:'value',sortable:true,hidden:false,width:100,editor:new Ext.form.TextField()},{id:'valueto',header:l('LBL_VALUE_TO'),dataIndex:'valueto',sortable:true,hidden:false,width:100,editor:new Ext.form.TextField()},{header:l('LBL_JOIN_TYPE'),readOnly:true,dataIndex:'jointype',width:80,sortable:true,hidden:false,renderer:function(value,metaData,record,rowIndex,colIndex,store){return value;},editor:new Ext.form.ComboBox({typeAhead:true,triggerAction:'all',lazyRender:true,mode:'local',store:new Ext.data.ArrayStore({id:0,fields:['jointype'],data:[['required'],['notexisting'],['optional']]}),displayField:'jointype'})},{header:l('LBL_USEREDITABLE'),readOnly:true,dataIndex:'usereditable',width:80,sortable:true,hidden:false,renderer:function(value,metaData,record,rowIndex,colIndex,store){return l('LBL_UEOPTION_'+value.toUpperCase());},editor:new Ext.form.ComboBox({typeAhead:true,triggerAction:'all',lazyRender:true,mode:'local',store:new Ext.data.ArrayStore({id:0,fields:['value','text'],data:[['yes',l('LBL_UEOPTION_YES')],['yfo',l('LBL_UEOPTION_YFO')],['yo1',l('LBL_UEOPTION_YO1')],['yo2',l('LBL_UEOPTION_YO2')],['no',l('LBL_UEOPTION_NO')]]}),displayField:'text',valueField:'value'})},{header:l('LBL_DASHLETEDITABLE'),readOnly:true,dataIndex:'dashleteditable',width:50,sortable:true,hidden:false,renderer:function(value,metaData,record,rowIndex,colIndex,store){return l('LBL_DEOPTION_'+value.toUpperCase());},editor:new Ext.form.ComboBox({typeAhead:true,triggerAction:'all',lazyRender:true,mode:'local',store:new Ext.data.ArrayStore({id:0,fields:['value','text'],data:[['yes',l('LBL_DEOPTION_YES')],['no',l('LBL_DEOPTION_NO')]]}),displayField:'text',valueField:'value'})},{id:'context',header:l('LBL_QUERYCONTEXT'),dataIndex:'context',sortable:true,hidden:false,width:150,editor:new Ext.form.TextField()},{id:'reference',header:l('LBL_QUERYREFERENCE'),dataIndex:'reference',sortable:true,hidden:false,width:150,editor:new Ext.form.TextField()}]);var ah=new Ext.grid.EditorGridPanel({ddGroup:'whereGridDDGroup',store:ai,cm:ag,flex:100,clicksToEdit:1,enableDragDrop:true,stripeRows:true,width:325,tbar:new Ext.Toolbar({items:[{text:l('LBL_DELETE_BUTTON_LABEL'),icon:'modules/KReports/images/delete.png',handler:function(){var aV=ah.getSelectionModel().getSelectedCell();ai.removeAt(aV[0]);ai.filter('groupid',bb.getSelectionModel().getSelectedNode().id);if(ai.getTotalCount>0||bb.getSelectionModel().getSelectedNode().parentNode===null){bA.disable();}else{bA.enable();}}}]})});ah.getView().markDirty=false;ah.on('beforeedit',function(e){aF(e,ag,ah);});ah.on('afteredit',function(e){aI(e,ag);});ah.on('click',function(e){whereGridLastClickXY=e.getXY();});KINAMU.kreports.cy=new Ext.Panel({title:l('LBL_WHERRE_CLAUSE_TITLE'),width:325,collapsed:true,layout:'vbox',layoutConfig:{align:'stretch',pack:'start'},items:[bb,ah]});var gb=new Ext.form.Radio({itemId:'gb',boxLabel:l('LBL_STANDARDGRIDPROPERTIES_SYNCHRONOUSCOUNT'),name:'syncCount'});var ev=new Ext.form.Radio({itemId:'ev',boxLabel:l('LBL_STANDARDGRIDPROPERTIES_ASYNCHRONOUSCOUNT'),name:'asyncCount'});var gp=new Ext.form.Radio({itemId:'gp',boxLabel:l('LBL_STANDARDGRIDPROPERTIES_NOCOUNT'),name:'noCount'});var standardGridPropertiesListEntries=new Ext.form.NumberField({fieldLabel:l('LBL_STANDARDGRIDENTRIES_COUNT'),});var standardGridViewForm=new Ext.FormPanel({labelAlign:'left',bodyStyle:'padding:5px',layout:'form',items:[{xtype:'radiogroup',id:'standardGridPropertiesCount',fieldLabel:l('LBL_STANDARDGRIDPROPERTIES_COUNT'),columns:1,items:[gb,ev,gp]},standardGridPropertiesListEntries]});var kreportsStandardGridPropertiesWindow=new Ext.Window({title:l('LBL_STANDARDGRIDPROPERTIES_POPUP_TITLE'),layout:'fit',width:600,height:200,closeAction:'hide',plain:true,draggable:true,modal:true,items:standardGridViewForm,listeners:{'show':function(){if(document.getElementById('listtypeproperties').value!=''){thisListTypePorperties=Ext.util.JSON.decode(document.getElementById('listtypeproperties').value);switch(thisListTypePorperties[0].counthandling){case 'Asynchronous':ev.setValue(true);break;case 'None':gp.setValue(true);break;default:gb.setValue(true);break;};if(thisListTypePorperties[1].listcount!=undefined)standardGridPropertiesListEntries.setValue(thisListTypePorperties[1].listcount);}}},buttons:[{text:l('LBL_CANCEL_BUTTON'),handler:function(){eA.hide();}},{text:l('LBL_CLOSE_BUTTON'),handler:function(){document.getElementById('listtypeproperties').value='[{"counthandling":"'+Ext.getCmp('standardGridPropertiesCount').getValue().itemId.replace('standardGridPropertiesCount','')+'"},{"listcount":"'+standardGridPropertiesListEntries.getValue()+'"}]';kreportsStandardGridPropertiesWindow.hide();}}]});function kreportsStandardGridPropertiesPopup(){kreportsStandardGridPropertiesWindow.show(this);};var eW=false;var ct=false;if(document.getElementById('kreporteredition').value=='premium')eW=true;var fK=new Ext.menu.CheckItem({text:l('LBL_LI_TOP10'),checked:false,group:'selectionlimit',id:'selectionlimit_top10',checkHandler:function(thisElement){if(thisElement.checked==true)document.getElementById('selectionlimit').value='top10';}});var fM=new Ext.menu.CheckItem({text:l('LBL_LI_TOP20'),checked:false,group:'selectionlimit',id:'selectionlimit_top20',checkHandler:function(thisElement){if(thisElement.checked==true)document.getElementById('selectionlimit').value='top20';}});var fL=new Ext.menu.CheckItem({text:l('LBL_LI_TOP50'),checked:false,group:'selectionlimit',id:'selectionlimit_top50',checkHandler:function(thisElement){if(thisElement.checked==true)document.getElementById('selectionlimit').value='top50';}});var fE=new Ext.menu.CheckItem({text:l('LBL_LI_NOLIMIT'),checked:false,group:'selectionlimit',id:'selectionlimit_nolimit',checkHandler:function(thisElement){if(thisElement.checked==true)document.getElementById('selectionlimit').value='nolimit';}});var kreportListViewOptionsMenutopContextItem=new Ext.form.TextField({});var listGridSelectListTypeValues=[['standard'],['grouped'],['grpwthsumm'],['grptree'],['edit'],['html']];var listGridSelectListTypeLoadLanguage=function(){var bq=function(record){record.set('text',l('LBL_LT_'+record.data.value.toUpperCase()));};listGridSelectListTypeStore.each(bq);};var fG=new Ext.menu.CheckItem({text:l('LBL_LT_STANDARD'),checked:false,group:'listtype',checkHandler:function(thisElement){if(!ct&&document.getElementById('listtype').value!='standard')document.getElementById('listtypeproperties').value='';if(thisElement.checked==true)document.getElementById('listtype').value='standard';P(document.getElementById('listtype').value);}});var dx=new Ext.menu.CheckItem({text:l('LBL_LT_HTML'),checked:false,group:'listtype',checkHandler:function(thisElement){if(thisElement.checked==true)document.getElementById('listtype').value='html';P(document.getElementById('listtype').value);}});var fD=new Ext.menu.CheckItem({text:l('LBL_LT_GROUPED'),checked:false,disabled: !eW,group:'listtype',checkHandler:function(thisElement){if(thisElement.checked==true)document.getElementById('listtype').value='grouped';P(document.getElementById('listtype').value);}});var fH=new Ext.menu.CheckItem({text:l('LBL_LT_GRPWTHSUM'),checked:false,disabled: !eW,group:'listtype',checkHandler:function(thisElement){if(thisElement.checked==true)document.getElementById('listtype').value='grpwthsum';P(document.getElementById('listtype').value);}});var fF=new Ext.menu.CheckItem({text:l('LBL_LT_GRPTREE'),checked:false,disabled: !eW,group:'listtype',checkHandler:function(thisElement){if(!ct&&document.getElementById('listtype').value!='grptree')document.getElementById('listtypeproperties').value='';if(thisElement.checked==true)document.getElementById('listtype').value='grptree';P(document.getElementById('listtype').value);}});var kreportListViewOptionsMenuViewEdit=new Ext.menu.CheckItem({text:l('LBL_LT_EDIT'),checked:false,disabled: !eW,group:'listtype',checkHandler:function(thisElement){if(!ct&&document.getElementById('listtype').value!='edit')document.getElementById('listtypeproperties').value='';if(thisElement.checked==true)document.getElementById('listtype').value='edit';P(document.getElementById('listtype').value);}});var eN=new Ext.menu.CheckItem({text:l('LBL_LT_PIVOT'),checked:false,disabled: !eW,group:'listtype',checkHandler:function(thisElement){if(!ct&&document.getElementById('listtype').value!='pivot')document.getElementById('listtypeproperties').value='';if(thisElement.checked==true)document.getElementById('listtype').value='pivot';P(document.getElementById('listtype').value);}});var fI=new Ext.menu.CheckItem({text:l('LBL_LI_PORTRAIT'),checked:false,disabled: !eW,group:'pdforientation',id:'pdforientation_portrait',checkHandler:function(thisElement){if(thisElement.checked==true)document.getElementById('pdforientation').value='Portrait';}});var fJ=new Ext.menu.CheckItem({text:l('LBL_LI_LANDSCAPE'),checked:false,disabled: !eW,group:'pdforientation',id:'pdforientation_landscape',checkHandler:function(thisElement){if(thisElement.checked==true)document.getElementById('pdforientation').value='Landscape';}});var U=new Ext.form.ComboBox({typeAhead:true,editable:false,triggerAction:'all',lazyRender:true,mode:'local',store:new Ext.data.ArrayStore({id:0,fields:['value','text'],data:[['P',l('LBL_LI_PORTRAIT')],['L',l('LBL_LI_LANDSCAPE')]]}),value:'P',valueField:'value',displayField:'text',listeners:{'change':function(){document.getElementById('pdforientation').value=U.getValue();kreportListViewOptionsMenupdfWriteValues();}}});var T=new Ext.form.ComboBox({typeAhead:true,editable:false,triggerAction:'all',lazyRender:true,mode:'local',store:new Ext.data.ArrayStore({id:0,fields:['value','text'],data:[['L',l('LBL_PDFTABLEPOS_LEFT')],['C',l('LBL_PDFTABLEPOS_CENTER')],['F',l('LBL_PDFTABLEPOS_FIT')],['R',l('LBL_PDFTABLEPOS_RIGHT')]]}),value:'C',valueField:'value',displayField:'text',listeners:{'change':function(){kreportListViewOptionsMenupdfWriteValues();}}});var aD=new Ext.form.ComboBox({typeAhead:true,editable:false,triggerAction:'all',lazyRender:true,mode:'local',store:new Ext.data.ArrayStore({id:0,fields:['value','text'],data:[['0',l('LBL_PDFCELLSTRETCH_NONE')],['1',l('LBL_PDFCELLSTRETCH_SCALE')],['2',l('LBL_PDFCELLSTRETCH_FORECSCALE')],['3',l('LBL_PDFCELLSTRETCH_SPACE')],['4',l('LBL_PDFCELLSTRETCH_FORESCPACE')],['5',l('LBL_PDFCELLSTRETCH_MULTILINE')]]}),valueField:'value',value:'0',displayField:'text',listeners:{'change':function(){kreportListViewOptionsMenupdfWriteValues();}}});var aN=new Ext.form.ComboBox({typeAhead:true,editable:false,triggerAction:'all',lazyRender:true,mode:'local',store:new Ext.data.ArrayStore({id:0,fields:['value','text'],data:[['A5',l('LBL_PDFFORMAT_A5')],['A4',l('LBL_PDFFORMAT_A4')],['A3',l('LBL_PDFFORMAT_A3')],['LETTER',l('LBL_PDFFORMAT_LETTER')],['LEGAL',l('LBL_PDFFORMAT_LEGAL')]]}),value:'A4',valueField:'value',displayField:'text',listeners:{'change':function(){kreportListViewOptionsMenupdfWriteValues();}}});var aH=new Ext.form.ComboBox({typeAhead:true,editable:false,triggerAction:'all',lazyRender:true,mode:'local',store:new Ext.data.ArrayStore({id:0,fields:['value','text'],data:[['6',l('LBL_PDFFONT_6PX')],['8',l('LBL_PDFFONT_8PX')],['10',l('LBL_PDFFONT_10PX')],['12',l('LBL_PDFFONT_12PX')]]}),value:'8',valueField:'value',displayField:'text',listeners:{'change':function(){kreportListViewOptionsMenupdfWriteValues();}}});var eC=new Ext.form.ComboBox({typeAhead:true,editable:false,triggerAction:'all',lazyRender:true,mode:'local',store:new Ext.data.ArrayStore({id:0,fields:['value','text'],data:[['0',l('LBL_DD_0')],['1',l('LBL_DD_1')]]}),value:'0',valueField:'value',displayField:'text',listeners:{'change':function(){kreportListViewOptionsMenupdfWriteValues();}}});function kreportListViewOptionsMenupdfWriteValues(){var pdfOptionObj=new Object();pdfOptionObj.format=aN.getValue();pdfOptionObj.fontsize=aH.getValue();pdfOptionObj.orientation=U.getValue();pdfOptionObj.cellstretch=aD.getValue();pdfOptionObj.tablepos=T.getValue();pdfOptionObj.showoptions=eC.getValue();document.getElementById('pdfoptions').value=Ext.util.JSON.encode(pdfOptionObj);};var fy=new Ext.menu.Menu({style:{overflow:'visible'},items:[{text:l('LBL_SELECTION_LIMIT'),icon:'modules/KReports/images/listlimit.png',menu:{items:[fE,fK,fM,fL]}},{text:l('LBL_PDFORIENTATION'),icon:'modules/KReports/images/acrobat.png',disabled: !eW,menu:{items:[l('LBL_PDF_PAGESIZE'),aN,l('LBL_PDF_ORIENTATION'),U,l('LBL_PDF_FONTSIZE'),aH,l('LBL_PDF_TABLEPOS'),T,l('LBL_PDF_CELLSTRETCH'),aD,l('LBL_PDF_SHOWOPTIONS'),eC]}},{text:l('LBL_LISTTYPE'),icon:'modules/KReports/images/listtypes.png',menu:{items:[fG,kreportListViewOptionsMenuViewEdit,dx,fD,fH,fF,eN,'-',{text:l('LBL_STANDARDPROPERTIES'),id:'standardpropertiesMenuItem',icon:'modules/KReports/images/reportoptions.png',handler:function(){kreportsStandardGridPropertiesPopup();},hidden:true},{text:l('LBL_EDITPROPERTIES'),id:'editpropertiesMenuItem',icon:'modules/KReports/images/reportoptions.png',handler:function(){kreportsStandardGridPropertiesPopup();},hidden:true},{text:l('LBL_GROUPEDPROPERTIES'),id:'groupedpropertiesMenuItem',icon:'modules/KReports/images/reportoptions.png',handler:function(){kreportsGroupedViewPropertiesPopup();},hidden:true},{text:l('LBL_TREEPROPERTIES'),id:'treepropertiesMenuItem',icon:'modules/KReports/images/reportoptions.png',handler:function(){ab();},hidden:true},{text:l('LBL_PIVOTPROPERTIES'),id:'pivotpropertiesMenuItem',icon:'modules/KReports/images/reportoptions.png',handler:function(){aj();},hidden:true}]}},{text:l('LBL_MAP'),icon:'modules/KReports/images/map.png',disabled: !eW,handler:function(){cs.show();}}]});function P(selectedLayout){Ext.getCmp('treepropertiesMenuItem').hide();Ext.getCmp('pivotpropertiesMenuItem').hide();Ext.getCmp('standardpropertiesMenuItem').hide();Ext.getCmp('editpropertiesMenuItem').hide();Ext.getCmp('groupedpropertiesMenuItem').hide();switch(selectedLayout){case '':case 'standard':Ext.getCmp('standardpropertiesMenuItem').show();break;case 'edit':Ext.getCmp('editpropertiesMenuItem').show();break;case 'grouped':case 'grpwthsum':Ext.getCmp('groupedpropertiesMenuItem').show();break;case 'grptree':Ext.getCmp('treepropertiesMenuItem').show();break;case 'pivot':Ext.getCmp('pivotpropertiesMenuItem').show();break;case 'html':break;}};fy.on('beforeshow',function(){ct=true;switch(document.getElementById('selectionlimit').value){case 'top10':fK.setChecked(true);break;case 'top20':fM.setChecked(true);break;case 'top50':fL.setChecked(true);break;default:fE.setChecked(true);break;}if(document.getElementById('pdfoptions').value!=''){var pdfOptionObj=Ext.util.JSON.decode(document.getElementById('pdfoptions').value);aN.setValue(pdfOptionObj.format);aH.setValue(pdfOptionObj.fontsize);aD.setValue(pdfOptionObj.cellstretch);T.setValue(pdfOptionObj.tablepos);eC.setValue(pdfOptionObj.showoptions);}U.setValue(document.getElementById('pdforientation').value);switch(document.getElementById('listtype').value){case 'grouped':fD.setChecked(true);break;case 'grpwthsum':fH.setChecked(true);break;case 'grptree':fF.setChecked(true);break;case 'pivot':eN.setChecked(true);break;case 'html':dx.setChecked(true);break;case 'edit':kreportListViewOptionsMenuViewEdit.setChecked(true);break;default:fG.setChecked(true);break;}P(document.getElementById('listtype').value);ct=false;});var L=[{name:'fieldid',mapping:'fieldid'},{name:'sequence',mapping:'sequence'},{name:'name',mapping:'name'},{name:'display',mapping:'display'},{name:'path',mapping:'path'},{name:'displaypath',mapping:'displaypath'},{name:'sort',mapping:'sort'},{name:'sortpriority',mapping:'sortpriority'},{name:'width',mapping:'width'},{name:'jointype',mapping:'jointype'},{name:'sqlfunction',mapping:'sqlfunction'},{name:'customsqlfunction',mapping:'customsqlfunction'},{name:'valuetype',mapping:'valuetype'},{name:'groupby',mapping:'groupby'},{name:'link',mapping:'link'},{name:'fixedvalue',mapping:'fixedvalue'},{name:'assigntovalue',mapping:'assigntovalue'},{name:'formulavalue',mapping:'formulavalue'},{name:'formulasequence',mapping:'formulasequence'},{name:'widget',mapping:'widget'}];var updateFormListfield=function(store){document.getElementById('listfields').value='[';alert('updazte');function cX(record){if(document.getElementById('listfields').value!='['){document.getElementById('listfields').value+=',';}document.getElementById('listfields').value+=Ext.util.JSON.encode(record.data);};A.each(cX);document.getElementById('listfields').value+=']';};Ext.namespace('KINAMU.kreports.eh');KINAMU.kreports.eh.kreportsJsonStore=Ext.extend(KINAMU.kreports.kreportsJsonStore,{constructor:function(config){KINAMU.kreports.eh.kreportsJsonStore.superclass.constructor.call(this,config);},add:function(records){KINAMU.kreports.dI.unionModules.addRecordsToUnion(records);KINAMU.kreports.eh.kreportsJsonStore.superclass.add.call(this,records);},remove:function(record){KINAMU.kreports.dI.unionModules.eT(record);KINAMU.kreports.eh.kreportsJsonStore.superclass.remove.call(this,record);},afterEdit:function(record){KINAMU.kreports.dI.unionModules.eO(record);KINAMU.kreports.eh.kreportsJsonStore.superclass.afterEdit.call(this,record);}});var A=new KINAMU.kreports.eh.kreportsJsonStore({fields:L,domElement:'listfields'});var ck=new Ext.grid.ColumnModel([{header:l('LBL_SEQUENCE'),readOnly:true,dataIndex:'sequence',width:30,sortable:true,hidden:true},{header:l('LBL_FULLPATH'),readOnly:true,dataIndex:'path',width:150,sortable:true,hidden:true},{header:l('LBL_PATH'),readOnly:true,dataIndex:'displaypath',width:150,sortable:false},{id:'name',header:l('LBL_NAME'),dataIndex:'name',sortable:false,width:150,editor:new Ext.form.TextField()},{header:l('LBL_DISPLAY'),readOnly:true,dataIndex:'display',width:50,sortable:false,hidden:false,editor:new Ext.form.ComboBox({typeAhead:true,triggerAction:'all',lazyRender:true,mode:'local',store:new Ext.data.ArrayStore({id:0,fields:['value','text'],data:[['no',l('LBL_NO')],['yes',l('LBL_YES')]]}),valueField:'value',displayField:'text'}),renderer:function(value){if(value!=undefined)return l('LBL_'+value.toUpperCase());else return value;}},{header:l('LBL_LINK'),readOnly:true,dataIndex:'link',width:50,sortable:false,hidden:false,editor:new Ext.form.ComboBox({typeAhead:true,triggerAction:'all',lazyRender:true,mode:'local',store:new Ext.data.ArrayStore({id:0,fields:['value','text'],data:[['no',l('LBL_NO')],['yes',l('LBL_YES')]]}),valueField:'value',displayField:'text'}),renderer:function(value){if(value!=undefined)return l('LBL_'+value.toUpperCase());else return value;}},{header:l('LBL_SORTSEQUENCE'),readOnly:true,dataIndex:'sort',width:50,sortable:false,hidden:false,editor:new Ext.form.ComboBox({typeAhead:true,triggerAction:'all',lazyRender:true,mode:'local',store:new Ext.data.ArrayStore({id:0,fields:['value','text'],data:[['-','-'],['asc',l('LBL_SORT_ASC')],['desc',l('LBL_SORT_DESC')],['sortable',l('LBL_SORT_SORTABLE')]]}),valueField:'value',displayField:'text'}),renderer:function(value){if(value!=undefined&&value!='-')return l('LBL_SORT_'+value.toUpperCase());else return value;}},{id:'sortpriority',header:l('LBL_SORTPRIORITY'),dataIndex:'sortpriority',sortable:false,width:50,editor:new Ext.form.NumberField()},{id:'width',header:l('LBL_WIDTH'),dataIndex:'width',sortable:false,width:50,editor:new Ext.form.NumberField()},{header:l('LBL_JOIN_TYPE'),readOnly:true,dataIndex:'jointype',width:70,sortable:true,hidden:false,editor:new Ext.form.ComboBox({typeAhead:true,triggerAction:'all',lazyRender:true,mode:'local',store:new Ext.data.ArrayStore({id:0,fields:['value','text'],data:[['optional',l('LBL_JT_OPTIONAL')],['required',l('LBL_JT_REQUIRED')]]}),valueField:'value',displayField:'text'}),renderer:function(value){if(value!=undefined&&value!='-')return l('LBL_JT_'+value.toUpperCase());else return value;}},{header:l('LBL_SQLFUNCTION'),readOnly:true,dataIndex:'sqlfunction',width:70,sortable:false,hidden:false,editor:new Ext.form.ComboBox({typeAhead:true,triggerAction:'all',lazyRender:true,mode:'local',store:new Ext.data.ArrayStore({id:0,fields:['value','text'],data:[['-','-'],['SUM',l('LBL_FUNCTION_SUM')],['COUNT',l('LBL_FUNCTION_COUNT')],['MAX',l('LBL_FUNCTION_MAX')],['MIN',l('LBL_FUNCTION_MIN')],['AVG',l('LBL_FUNCTION_AVG')],['GROUP_CONCAT',l('LBL_FUNCTION_GROUP_CONCAT')]]}),valueField:'value',displayField:'text'}),renderer:function(value){if(value!=undefined&&value!='-')return l('LBL_FUNCTION_'+value.toUpperCase());else return value;}},{header:l('LBL_CUSTOMSQLFUNCTION'),readOnly:true,dataIndex:'customsqlfunction',width:70,sortable:false,hidden:false,editor:new Ext.form.TextField()},{header:l('LBL_VALUETYPE'),readOnly:true,dataIndex:'valuetype',width:70,sortable:false,hidden:false,editor:new Ext.form.ComboBox({typeAhead:true,triggerAction:'all',lazyRender:true,mode:'local',store:new Ext.data.ArrayStore({id:0,fields:['value','text'],data:[['-','-'],['TOFSUM',l('LBL_VALUETYPE_TOFSUM')],['POFSUM',l('LBL_VALUETYPE_POFSUM')],['POFCOUNT',l('LBL_VALUETYPE_POFCOUNT')],['POFAVG',l('LBL_VALUETYPE_POFAVG')],['DOFSUM',l('LBL_VALUETYPE_DOFSUM')],['DOFCOUNT',l('LBL_VALUETYPE_DOFCOUNT')],['DOFAVG',l('LBL_VALUETYPE_DOFAVG')]]}),valueField:'value',displayField:'text'}),renderer:function(value){if(value!=undefined&&value!='-'&&value!='')return l('LBL_VALUETYPE_'+value.toUpperCase());else return value;}},{header:l('LBL_GROUPBY'),readOnly:true,dataIndex:'groupby',width:70,sortable:true,hidden:false,editor:new Ext.form.ComboBox({typeAhead:true,triggerAction:'all',lazyRender:true,mode:'local',store:new Ext.data.ArrayStore({id:0,fields:['value','text'],data:[['no',l('LBL_NO')],['yes',l('LBL_YES')]]}),valueField:'value',displayField:'text'}),renderer:function(value){if(value!=undefined)return l('LBL_'+value.toUpperCase());else return value;}},{id:'widget',header:l('LBL_WIDGET'),dataIndex:'widget',sortable:false,width:80,editor:new Ext.form.TextField()},{id:'fixedvalue',header:l('LBL_FIXEDVALUE'),dataIndex:'fixedvalue',sortable:false,width:80,editor:new Ext.form.TextField()},{id:'assigntovalue',header:l('LBL_ASSIGNTOVALUE'),dataIndex:'assigntovalue',sortable:false,width:40,editor:new Ext.form.TextField(),hidden:false},{id:'formulavalue',header:l('LBL_FORMULAVALUE'),dataIndex:'formulavalue',sortable:false,width:80,editor:new Ext.form.TextField(),hidden:false},{id:'formulasequence',header:l('LBL_FORMULASEQUENCE'),dataIndex:'formulasequence',sortable:false,width:30,editor:new Ext.form.NumberField(),hidden:false}]);var cS=new Ext.Button({text:l('LBL_DOWN'),icon:'modules/KReports/images/arrow_down.png'});var bd=new Ext.grid.EditorGridPanel({ddGroup:'listGridDDGroup',store:A,cm:ck,sm:new Ext.grid.RowSelectionModel(),clicksToEdit:1,enableDragDrop:true,stripeRows:true,autoExpandColumn:'name',width:325,title:l('LBL_LISTFIELDS'),tbar:new Ext.Toolbar({items:[{text:l('LBL_DOWN_BUTTON_LABEL'),icon:'modules/KReports/images/arrow_down.png',handler:function(){if(bd.getSelectionModel().hasSelection()&&A.indexOf(bd.getSelectionModel().getSelected())<(A.getCount()-1)){var thisRecord=bd.getSelectionModel().getSelected();var bI=A.getAt(A.indexOf(bd.getSelectionModel().getSelected())+1);var bu=thisRecord.data.sequence;var cc=bI.data.sequence;thisRecord.set('sequence',cc);bI.set('sequence',bu);A.sort('sequence','ASC');}}},{text:l('LBL_UP_BUTTON_LABEL'),icon:'modules/KReports/images/arrow_up.png',handler:function(){if(bd.getSelectionModel().hasSelection()&&A.indexOf(bd.getSelectionModel().getSelected())!=0){var thisRecord=bd.getSelectionModel().getSelected();var bG=A.getAt(A.indexOf(bd.getSelectionModel().getSelected())-1);var bu=thisRecord.data.sequence;var ca=bG.data.sequence;thisRecord.set('sequence',ca);bG.set('sequence',bu);A.sort('sequence','ASC');}}},{text:l('LBL_ADDEMTPY_BUTTON_LABEL'),icon:'modules/KReports/images/add.png',handler:function(){var cd=Ext.data.Record.create(L);var bi=new cd({fieldid:cV(),name:'enter name',path:'',displaypath:'',display:'yes',sequence:A.getNextSequence(),width:'100',sort:'-',sortpriority:'',jointype:'required',sqlfunction:'-',groupby:'no',link:'no',fixedvalue:''});A.add(bi);}},{text:l('LBL_DELETE_BUTTON_LABEL'),icon:'modules/KReports/images/delete.png',handler:function(){A.remove(bd.getSelectionModel().getSelected());}},{text:l('LBL_LISTVIEW_OPTIONS'),icon:'modules/KReports/images/tools.png',menu:fy}]})});bd.getView().markDirty=false;Ext.namespace('KINAMU.kreports.unionList');KINAMU.kreports.unionList.ds=[{name:'joinid',mapping:'joinid'},{name:'fieldid',mapping:'fieldid'},{name:'sequence',mapping:'sequence'},{name:'name',mapping:'name'},{name:'unionfieldpath',mapping:'unionfieldpath'},{name:'unionfielddisplaypath',mapping:'unionfielddisplaypath'},{name:'unionfieldname',mapping:'unionfieldname'},{name:'path',mapping:'path'},{name:'displaypath',mapping:'displaypath'},{name:'fixedvalue',mapping:'fixedvalue'}];KINAMU.kreports.unionList.bf=new KINAMU.kreports.kreportsJsonStore({fields:KINAMU.kreports.unionList.ds,domElement:'unionlistfields',deleteWithUnionId:function(nodeID){this.clearFilter();var i=this.find('joinid',nodeID);while(i!= -1){this.removeAt(i);i=this.find('joinid',nodeID);}this.clearFilter();},listeners:{'load':function(thisStore){thisStore.each(function(thisRecord){listFieldRecord=A.getAt(A.find('fieldid',thisRecord.data.fieldid));thisRecord.data.name=listFieldRecord.data.name;thisRecord.data.sequence=listFieldRecord.data.sequence;thisRecord.data.path=listFieldRecord.data.path;thisRecord.data.displaypath=listFieldRecord.data.displaypath;});}}});KINAMU.kreports.unionList.di='';KINAMU.kreports.unionList.dP=function(dn){KINAMU.kreports.unionList.di=dn;theseRecords=new Array();function aULR(r,index,bV){var bT=Ext.data.Record.create(KINAMU.kreports.unionList.ds);var tNR=new bT({joinid:KINAMU.kreports.unionList.di,fieldid:r.data.fieldid,sequence:r.data.sequence,unionfieldpath:'',unionfielddisplaypath:'',unionfieldname:'',fixedvalue:'',name:r.data.name,path:r.data.path,displaypath:r.data.displaypath});theseRecords.push(tNR);};A.each(aULR);KINAMU.kreports.unionList.bf.add(theseRecords);};KINAMU.kreports.unionList.dA=new Ext.grid.ColumnModel([{header:l('LBL_SEQUENCE'),readOnly:true,dataIndex:'sequence',width:30,sortable:true,hidden:true},{header:l('LBL_PATH'),readOnly:true,dataIndex:'displaypath',width:150,sortable:false},{id:'name',header:l('LBL_NAME'),dataIndex:'name',sortable:false,width:100},{id:'unionfielddisplaypath',header:l('LBL_UNIONFIELDDISPLAYPATH'),dataIndex:'unionfielddisplaypath',width:150,sortable:false},{id:'unionfieldname',header:l('LBL_UNIONFIELDNAME'),dataIndex:'unionfieldname',width:100,sortable:false},{id:'fixedvalue',header:l('LBL_FIXEDVALUE'),dataIndex:'fixedvalue',sortable:false,width:80,editor:new Ext.form.TextField()}]);KINAMU.kreports.unionList.bE=new Ext.grid.EditorGridPanel({ddGroup:'unionListGridDDGroup',store:KINAMU.kreports.unionList.bf,cm:KINAMU.kreports.unionList.dA,sm:new Ext.grid.RowSelectionModel(),clicksToEdit:1,enableDragDrop:true,stripeRows:true,autoExpandColumn:'name',width:325,title:l('LBL_UNIONLISTFIELDS'),hidden:true});aW=new Ext.data.Store({id:'aW',proxy:new Ext.data.HttpProxy({url:'index.php?module=KReports&action=get_fields&to_pdf=true'}),reader:new Ext.data.JsonReader({},[{name:'id',type:'string'},{name:'text',type:'string'},{name:'name',type:'string'},{name:'type',type:'string'},{name:'leaf',type:'boolean'}]),sortInfo:{field:'text',direction:"ASC"},loadByNodeId:function(node){this.baseParams.nodeid=node.id;this.load();bc.setTitle(bD(node));bj.setValue('');}});bL=new Ext.grid.ColumnModel([{header:'Fieldname',readOnly:true,dataIndex:'text',width:150,sortable:true,hidden:true},{header:'Name',dataIndex:'name',sortable:true,width:150}]);bL.defaultSortable=true;var bj=new Ext.form.TextField({enableKeyEvents:true,emptyText:l('LBL_ENTER_SEARCH_TERM')});bj.on('valid',function(field){aW.filter('name',field.getValue(),true,false);});bc=new Ext.grid.GridPanel({title:'...',store:aW,cm:bL,clicksToEdit:1,flex:1,loadMask:true,region:'center',stripeRows:true,width:200,maxSize:200,frame:false,enableDragDrop:true,ddGroup:'fieldGridDDGroup',viewConfig:{forceFit:true},tbar:new Ext.Toolbar({items:[bj]})});var co=function(node){var be=node.id;var currentNode=node;while(currentNode.parentNode){currentNode=currentNode.parentNode;be=currentNode.id+'::'+be;}return be;};var bC='';var bD=function(node){bC=co(node);var be=node.text;var currentNode=node;while(currentNode.parentNode){currentNode=currentNode.parentNode;be=currentNode.text+'::'+be;}return be;};var bB=new Ext.tree.TreeLoader({dataUrl:'index.php?module=KReports&action=get_nodes&to_pdf=true',baseParams:{requester:"TREE"}});bB.on("beforeload",function(bN,node){bN.baseParams.currentnodeid=node.attributes.id;},this);bB.on("load",function(bN,node){aW.baseParams.nodeid=node.attributes.id;aW.load();},this);var bo=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:'index.php?module=KReports&action=get_modules&to_pdf=true'}),reader:new Ext.data.JsonReader({'fields':[{name:'module'},{name:'description'}]})});bo.load();var ao=new Ext.form.ComboBox({store:bo,id:'module_combo',name:'module_combo',valueField:'module',displayField:'description',typeAhead:true,mode:'local',triggerAction:'all',emptyText:l('LBL_SELECT_MODULE'),aR:true,width:135});var bx=function(){if(ao.value==''){bz.setVisible(false);ao.setDisabled(false);}else{bz.setVisible(false);ao.setDisabled(true);}};var bz=new Ext.Button({resizable:true,icon:'modules/KReports/images/lock_open.png',handler:function(){Ext.Msg.confirm('unlock Root Module','changing the root module will erase all Defintions',function(f,text){if(f=='yes'){ao.clearValue();bo.load();bo.removeAll();ad.removeAll();ai.removeAll();A.removeAll();aW.removeAll();ef.root.destroy();bW();bx();}});}});var er=new Ext.tree.AsyncTreeNode({text:ao.value,draggable:false,id:"root:"+ao.value});var ci=function(){ao.setValue(Ext.get('report_module').dom.value);};var cl=function(){if(ao.value!=''){er.setId("root:"+ao.value);er.setText(ao.value);ef.root.select();}else{}};var ef=new Ext.tree.TreePanel({title:'Modules',id:'tree-panel',flex:1,split:true,width:200,minSize:100,autoScroll:true,selModel:new Ext.tree.DefaultSelectionModel({listeners:{'selectionchange':function(selModel,node){aW.loadByNodeId(node);}}}),rootVisible:true,lines:false,singleExpand:true,useArrows:true,enableDragDrop:false,loader:bB,root:er,tbar:new Ext.Toolbar({items:[ao,bz]}),listeners:{'expandnode':function(node){aW.loadByNodeId(node);}}});ef.on('expand',function(){bd.show();if(!KINAMU.kreports.unionList.bE.collapsed)bd.expand();KINAMU.kreports.unionList.bE.hide();KINAMU.kreports.cy.show();aW.loadByNodeId(ef.getSelectionModel().getSelectedNode());cj();fW.show();});ao.on('select',function(){var aY=new Ext.tree.AsyncTreeNode({text:ao.value,draggable:false,id:"root:"+ao.value});ef.setRootNode(aY);ai.removeAll();A.removeAll();aW.removeAll();aW.loadByNodeId(aY);bx();document.getElementById('report_module').value=ao.value;});ef.getSelectionModel().on('selectionchange',function(){});Ext.namespace('KINAMU.kreports.dI');KINAMU.kreports.dI.dD=new Ext.tree.TreeLoader({dataUrl:'index.php?module=KReports&action=get_nodes&to_pdf=true',baseParams:{requester:"TREE"}});KINAMU.kreports.dI.unionModuleFields=[{name:'unionid',mapping:'unionid'},{name:'module',mapping:'module'}];KINAMU.kreports.dI.unionModules=new KINAMU.kreports.kreportsJsonStore({fields:KINAMU.kreports.dI.unionModuleFields,domElement:'union_modules',addRecordsToUnion:function(records){var ep=Ext.data.Record.create(KINAMU.kreports.unionList.ds);for(G=0;G<this.data.items.length;G++){if(records.length){for(recordIndex=0;recordIndex<records.length;recordIndex++){KINAMU.kreports.unionList.bf.add(new ep({joinid:this.data.items[G].data.unionid,fieldid:records[recordIndex].get('fieldid'),sequence:records[recordIndex].get('sequence'),name:records[recordIndex].get('name'),path:records[recordIndex].get('path'),displaypath:records[recordIndex].get('displaypath')}));}}else{KINAMU.kreports.unionList.bf.add(new ep({joinid:this.data.items[G].data.unionid,fieldid:records.get('fieldid'),sequence:records.get('sequence'),name:records.get('name'),path:records.get('path'),displaypath:records.get('displaypath')}));}}KINAMU.kreports.unionList.bf.filter('joinid',KINAMU.kreports.dI.cI());},eT:function(record){if(record!=undefined){KINAMU.kreports.unionList.bf.clearFilter();while(KINAMU.kreports.unionList.bf.find('fieldid',record.get('fieldid'))>=0){KINAMU.kreports.unionList.bf.remove(KINAMU.kreports.unionList.bf.getAt(KINAMU.kreports.unionList.bf.find('fieldid',record.get('fieldid'))));}KINAMU.kreports.unionList.bf.filter('joinid',KINAMU.kreports.dI.cI());}},eO:function(record){KINAMU.kreports.unionList.bf.clearFilter();var startIndex=0;while(KINAMU.kreports.unionList.bf.find('fieldid',record.get('fieldid'),startIndex)>=0){updateRecord=KINAMU.kreports.unionList.bf.getAt(KINAMU.kreports.unionList.bf.find('fieldid',record.get('fieldid'),startIndex));updateRecord.beginEdit();updateRecord.set('sequence',record.get('sequence'));updateRecord.set('name',record.get('name'));updateRecord.set('path',record.get('path'));updateRecord.set('displaypath',record.get('displaypath'));updateRecord.endEdit();startIndex=KINAMU.kreports.unionList.bf.indexOf(updateRecord)+1;}KINAMU.kreports.unionList.bf.sort('sequence','ASC');KINAMU.kreports.unionList.bf.filter('joinid',KINAMU.kreports.dI.cI());}});var unionModules='';KINAMU.kreports.dI.dO=function(){KINAMU.kreports.dI.unionModules.loadDirect();for(i=0;i<KINAMU.kreports.dI.unionModules.getCount();i++){var cJ=new Ext.tree.AsyncTreeNode({text:KINAMU.kreports.dI.unionModules.getAt(i).get('module'),draggable:false,id:"union"+KINAMU.kreports.dI.unionModules.getAt(i).get('unionid')+':'+KINAMU.kreports.dI.unionModules.getAt(i).get('module')});KINAMU.kreports.dI.bh.getRootNode().appendChild(cJ);}if(KINAMU.kreports.dI.unionModules.getCount()>0){KINAMU.kreports.dI.bh.getRootNode().firstChild.select();}};KINAMU.kreports.dI.dM=function(node){var be=node.id;var currentNode=node;while(currentNode.parentNode&&currentNode.parentNode.id!='unionroot'){currentNode=currentNode.parentNode;be=currentNode.id+'::'+be;}return be;};KINAMU.kreports.dI.du=function(node){bC=co(node);var be=node.text;var currentNode=node;while(currentNode.parentNode&&currentNode.parentNode.id!='unionroot'){currentNode=currentNode.parentNode;be=currentNode.text+'::'+be;}return be;};KINAMU.kreports.dI.dW=function(node){if(node.parentNode.id=='unionroot')return true;else return false;};KINAMU.kreports.dI.dN=function(node){var currentNode=node;while(currentNode.parentNode&&currentNode.parentNode.id!='unionroot'){currentNode=currentNode.parentNode;}return currentNode;};KINAMU.kreports.dI.cI=function(node){if(node==null||node!=undefined){if(KINAMU.kreports.dI.unionModules.getCount()>0){node=KINAMU.kreports.dI.bh.getSelectionModel().getSelectedNode();}else return '';}var currentNode=node;while(currentNode.parentNode&&currentNode.parentNode.id!='unionroot'){currentNode=currentNode.parentNode;}var splitArray=currentNode.id.split(':');return splitArray[0].replace('union','');};KINAMU.kreports.dI.es=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:'index.php?module=KReports&action=get_modules&to_pdf=true'}),reader:new Ext.data.JsonReader({'fields':[{name:'module'},{name:'description'}]})});KINAMU.kreports.dI.es.load();KINAMU.kreports.dI.cF=new Ext.form.ComboBox({store:KINAMU.kreports.dI.es,id:'union_module_combo',name:'union_module_combo',valueField:'module',displayField:'description',typeAhead:true,mode:'local',triggerAction:'all',emptyText:'Select a module.',aR:true,width:100,listeners:{'select':function(){KINAMU.kreports.dI.df.enable();}}});KINAMU.kreports.dI.dG=new Ext.Button({icon:'modules/KReports/images/delete.png',handler:function(){Ext.Msg.confirm('remove Union Module','remove the Union module and all related definitions',function(f,text){if(f=='yes'){KINAMU.kreports.unionList.bf.deleteWithUnionId(KINAMU.kreports.dI.cI(KINAMU.kreports.dI.bh.getSelectionModel().getSelectedNode()));KINAMU.kreports.dI.unionModules.remove(KINAMU.kreports.dI.unionModules.getAt(KINAMU.kreports.dI.unionModules.find('unionid',KINAMU.kreports.dI.bh.getSelectionModel().getSelectedNode().id.substring(5,33))));KINAMU.kreports.dI.dN(KINAMU.kreports.dI.bh.getSelectionModel().getSelectedNode()).destroy();if(KINAMU.kreports.dI.bn.hasChildNodes()){KINAMU.kreports.dI.bn.childNodes[0].select();KINAMU.kreports.unionList.bf.filter('joinid',KINAMU.kreports.dI.cI(KINAMU.kreports.dI.bn.childNodes[0]));}}});}});KINAMU.kreports.dI.df=new Ext.Button({icon:'modules/KReports/images/add.png',handler:function(){var newGuid=cV();var eI=Ext.data.Record.create(KINAMU.kreports.dI.unionModuleFields);var eF=new eI({unionid:newGuid,module:KINAMU.kreports.dI.cF.value});KINAMU.kreports.dI.unionModules.add(eF);var cJ=new Ext.tree.AsyncTreeNode({text:KINAMU.kreports.dI.cF.value,draggable:false,id:"union"+newGuid+":"+KINAMU.kreports.dI.cF.value});KINAMU.kreports.dI.bh.getRootNode().appendChild(cJ);cJ.select();KINAMU.kreports.unionList.dP(newGuid);KINAMU.kreports.dI.cF.clearValue();KINAMU.kreports.dI.df.disable();},disabled:true});KINAMU.kreports.dI.bn=new Ext.tree.AsyncTreeNode({text:ao.value,draggable:false,id:"unionroot"});KINAMU.kreports.dI.dr=function(){if(KINAMU.kreports.dI.bn.hasChildNodes())KINAMU.kreports.cy.show();else KINAMU.kreports.cy.hide();};KINAMU.kreports.dI.bh=new Ext.tree.TreePanel({title:l('LBL_UNIONTREE'),id:'uniontree-panel',flex:1,split:true,width:200,minSize:100,autoScroll:true,rootVisible:false,lines:false,singleExpand:true,useArrows:true,enableDragDrop:false,disabled:false,loader:KINAMU.kreports.dI.dD,root:KINAMU.kreports.dI.bn,tbar:new Ext.Toolbar({items:[KINAMU.kreports.dI.dG,'-',KINAMU.kreports.dI.df,KINAMU.kreports.dI.cF]}),listeners:{'expand':function(){KINAMU.kreports.unionList.bE.show();if(!bd.collapsed)KINAMU.kreports.unionList.bE.expand();bd.hide();if(!KINAMU.kreports.dI.bn.hasChildNodes()){KINAMU.kreports.cy.hide();}else{cj();aW.loadByNodeId(KINAMU.kreports.dI.bh.getSelectionModel().getSelectedNode());}},'append':KINAMU.kreports.dI.dr,'remove':KINAMU.kreports.dI.dr}});KINAMU.kreports.dI.bh.getSelectionModel().on('selectionchange',function(selectionModel,node){if(node!=null){aW.loadByNodeId(node);KINAMU.kreports.unionList.bf.filter('joinid',KINAMU.kreports.dI.cI(node));cj();}});var cp=function(){var bS=ah.getView().el.dom.childNodes[0].childNodes[1];var cQ=new Ext.dd.DropTarget(bS,{ddGroup:'fieldGridDDGroup',copy:false,notifyDrop:function(cu,e,data){function cU(record,index,bV){var bT=Ext.data.Record.create(KINAMU.kreports.aO);var bi=new bT({unionid:cf(),fieldid:cV(),path:bC+'::'+record.data.id,name:record.data.name,type:record.data.type,displaypath:bc.title,groupid:currentNode.id,referencefieldid:'',operator:'equals',jointype:'required',usereditable:'no',dashleteditable:'no',exportpdf:'no'});ai.add(bi);};Ext.each(cu.dragData.selections,cU);ai.sort('name','ASC');ai.filter([{property:'groupid',value:bb.getSelectionModel().getSelectedNode().id},{property:'unionid',value:cf()}]);bA.disable();return(true);}});var cg=bd.getView().el.dom.childNodes[0].childNodes[1];var cO=new Ext.dd.DropTarget(cg,{ddGroup:'fieldGridDDGroup',copy:false,notifyDrop:function(cu,e,data){function cU(record,index,bV){var bU=A.findExact('path',bc.title+'::'+record.data.id);if(bU== -1){var cd=Ext.data.Record.create(L);var bi=new cd({fieldid:cV(),path:bC+'::'+record.data.id,displaypath:bc.title,name:record.data.name,display:'yes',sequence:A.getNextSequence(),width:'100',sort:'-',sortpriority:'',jointype:'required',sqlfunction:'-',groupby:'no',link:'no',fixedvalue:''});A.add(bi);A.sort('sequence','ASC');}};Ext.each(cu.dragData.selections,cU);return(true);}});var dH=KINAMU.kreports.unionList.bE.getView().scroller.dom;var ee='';var ec=new Ext.dd.DropTarget(dH,{ddGroup:'fieldGridDDGroup',copy:false,onNodeEnter:function(target,dd,e,dragData){alert('enter');},notifyDrop:function(cu,e,data){var dq=[{name:'fieldid',mapping:'fieldid'},{name:'name',mapping:'name'}];var dk=new Ext.data.JsonStore({fields:dq});function fQ(record,index,bV){var bT=Ext.data.Record.create(dq);var bi=new bT({fieldid:record.data.fieldid,name:record.data.name});dk.add(bi);};KINAMU.kreports.unionList.bf.each(fQ);cE=cu.dragData.selections[0];var cL=new Ext.grid.GridPanel({store:dk,columns:[{id:'fieldid',header:l('LBL_MULTISELECT_TEXT_HEADER'),hidden:true},{id:'name',header:l('LBL_MULTISELECT_TEXT_HEADER')}],selModel:new Ext.grid.RowSelectionModel({singleSelect:true}),stripeRows:true,autoExpandColumn:'name',height:350,width:400});var setPathFromDialog=function(){win.hide();var selectedRecord=cL.getSelectionModel().getSelected();var recordIndex=KINAMU.kreports.unionList.bf.find('fieldid',selectedRecord.data.fieldid);var record=KINAMU.kreports.unionList.bf.getAt(recordIndex);record.set('unionfieldpath',KINAMU.kreports.dI.dM(KINAMU.kreports.dI.bh.getSelectionModel().getSelectedNode())+'::'+cE.data.id);record.set('unionfieldname',cE.data.name);record.set('unionfielddisplaypath',KINAMU.kreports.dI.du(KINAMU.kreports.dI.bh.getSelectionModel().getSelectedNode()));};cL.on('celldblclick',setPathFromDialog);var win=new Ext.Window({title:l('LBL_MUTLISELECT_POPUP_TITLE'),layout:'fit',width:500,height:300,closeAction:'hide',plain:true,draggable:true,modal:true,items:cL,buttons:[{text:l('LBL_MUTLISELECT_CANCEL_BUTTON'),handler:function(){win.hide();}},{text:l('LBL_MUTLISELECT_CLOSE_BUTTON'),handler:setPathFromDialog}]});win.show(this);return(true);}});};Ext.onReady(function(){KINAMU.kreports.EditView=true;ad.loadDirect();cj();ai.loadDirect();A.loadDirect();KINAMU.kreports.unionList.bf.loadDirect();if(document.getElementById('chart_params_new').value!='')eg.loadData(Ext.util.JSON.decode(document.getElementById('chart_params_new').value));if(document.getElementById('kreporteredition').value=='premium')KINAMU.kreports.eZ=new Ext.Panel({region:'center',split:true,width:600,height:500,layout:'accordion',items:[KINAMU.kreports.cy,bd,KINAMU.kreports.unionList.bE,fW]});else KINAMU.kreports.eZ=new Ext.Panel({region:'center',split:true,width:600,height:500,layout:'accordion',items:[KINAMU.kreports.cy,bd,KINAMU.kreports.unionList.bE]});KINAMU.kreports.fa=new Ext.Panel({title:l('LBL_MODULES'),width:200,height:300,layout:'accordion',activeOnTop:true,items:[ef,KINAMU.kreports.dI.bh]});KINAMU.kreports.modulePanel=new Ext.Panel({region:'west',width:200,height:600,collapsible:false,layout:'vbox',layoutConfig:{align:'stretch',pack:'start'},items:[KINAMU.kreports.fa,bc]});var cP=new Ext.Panel({renderTo:'layoutregion',monitorResize:true,height:600,layout:'border',layoutConfig:{align:'stretch',pack:'pack'},defaults:{flex:1},items:[KINAMU.kreports.modulePanel,KINAMU.kreports.eZ]});if(ao.value!=''){ci();cl();bx();KINAMU.kreports.dI.dO();aW.baseParams.nodeid=ef.root.id;aW.load();bc.setTitle(bD(ef.root));bj.setValue('');bb.root.select();bK(bb.root);}if(document.getElementById('kreporteredition').value=='premium'){if(document.getElementById('colorschema').value!=''){var colorschema;eval("colorschema = "+document.getElementById('colorschema').value);ga.loadData(colorschema);}if(document.getElementById('chartstyles').value!=''){var colorschema;eval("chartstyles = "+document.getElementById('chartstyles').value);cStylesStore.loadData(chartstyles);}if(document.getElementById('linestyles').value!=''){var linestyles;eval("linestyles = "+document.getElementById('linestyles').value);KINAMU.kreports.chartParams.dh.loadData(linestyles);}cIndexComboStoreFill(cLayoutCount[cLayoutCombo.value]);}cp();window.onbeforeunload=null;});